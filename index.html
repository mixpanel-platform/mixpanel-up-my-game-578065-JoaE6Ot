<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="https://cdn.mxpnl.com/libs/mixpanel-platform/css/reset.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.mxpnl.com/libs/mixpanel-platform/build/mixpanel-platform.v0.latest.min.css">
    <script src="https://cdn.mxpnl.com/libs/mixpanel-platform/build/mixpanel-platform.v0.latest.min.js"></script>
    <style>
      table#resultsTable {
        width: 100%; 
        background-color: #f1f1c1;
        border: 1;
        align: center;
      }
    </style>
  </head>
  <body class="mixpanel-platform-body">
    <table id="resultsTable">
      <tr>
        <td><b>Activity</b></td>
        <td>Count</td>
      </tr>
    </table>
    
    <script>
    
    var params = {
          from: '2015-01-01',
          to: '2015-04-30',
          type: 'general',
          unit: 'month'
        };
    
    var runQuery = function(event, where) {
      params['where'] = where;
      MP.api.segment(event, {}, where).done(function(results) {
        params['where'].delete;
        console.log(results.values());
        return results.values();
      });
    };
    
    var queryNav = function() {
      promiselist = [];
      
      promiselist.push(runQuery("Video Open", '(string(properties["Video Owner"]) == "false"))'));
      promiselist.push(runQuery("Review", '(string(properties["Role"]) == "Reviewee"))'));
      var recVideo = 1;
      var vidShare = 1;
      var comments = 1;
      promiselist.push(runQuery("Review", '(string(properties["Role"]) == "Reviewer"))'));
      promiselist.push(runQuery("Review", '(string(properties["Type"]) == "Paid"))'));
      
      Promise.all(promiselist).then(function(promiseArray){
        var vidWatch = promiseArray[0];
        var revWatch = promiseArray[1];
        var reviewed = promiseArray[2];
        var paid = promiseArray[3];
        $('table#resultsTable').append(
            '<tr>' +
            '<td>' + "Video Watch" + '</td>' +
            '<td>' + vidWatch + '</td>' +
            '</tr>'
          );
      })
    }
    
    queryNav();
     
    </script>
  </body>
</html>
